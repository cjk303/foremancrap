[Unit]
Description=BIND Prometheus Exporter
After=network.target

[Service]
Type=simple
ExecStart=/usr/bin/python3 /opt/bind_exporter/bind_exporter.py
WorkingDirectory=/opt/bind_exporter
User=root
Group=root
Environment=PYTHONUNBUFFERED=1

# Auto-restart on crash or leak
Restart=always
RestartSec=5

# ---------- Resource Limits ----------
LimitNOFILE=4096
MemoryMax=200M
TimeoutStopSec=10
KillMode=process

# ---------- Security Hardening ----------
NoNewPrivileges=yes
ProtectSystem=full
ProtectHome=yes
PrivateTmp=yes

# ---------- Network Access Controls ----------
# Deny all by default, allow only Prometheus server
IPAddressDeny=any
IPAddressAllow=10.76.41.82

[Install]
WantedBy=multi-user.target
